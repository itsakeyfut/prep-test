# Tail Recursion (æœ«å°¾å†å¸°)

## âœ… æœ«å°¾å†å¸°ã¨ã¯ï¼Ÿ

é–¢æ•°ã®**æœ€å¾Œã®å‡¦ç†ãŒã€Œè‡ªåˆ†è‡ªèº«ã®å‘¼ã³å‡ºã—ã€**ã«ãªã£ã¦ã„ã‚‹å†å¸°ã®ã“ã¨ã€‚

### æ™®é€šã®å†å¸°ï¼ˆéæœ«å°¾å†å¸°ï¼‰

```rs
fn factorial(n: u32) -> u32 {
    if n == 0 { 1 }
    else { n * factorial(n - 1) } // ã“ã“ã§ n ã¨æ›ã‘ç®—ã—ã¦ã‹ã‚‰æˆ»ã£ã¦ãã‚‹å¿…è¦ãŒã‚ã‚‹
}
```

### æœ«å°¾å†å¸°ï¼ˆTail Recursionï¼‰

```rs
fn factorial_tail(n: u32, acc: u32) -> u32 {
    if n == 0 { acc }
    else { factorial_tial(n - 1, acc * n) } // æœ€å¾ŒãŒå†å¸°å‘¼ã³å‡ºã—ã®ã¿
}

fn main() {
    println!("{}", factorial_tail(5, 1)); // 120
}
```

æœ«å°¾å†å¸°ã®åˆ©ç‚¹ï¼š

- æœ€é©åŒ–å¯èƒ½
  - ãŸã ã— Rust ã¯è‡ªå‹•ã§ã‚„ã£ã¦ãã‚Œãªã„
- æ˜ç¤ºçš„ã«ã‚¹ã‚¿ãƒƒã‚¯ã‚’ç¯€ç´„ã—ãŸè¨­è¨ˆã«ã§ãã‚‹
  - `loop` ã«æ›¸ãæ›ãˆã‚„ã™ã„

## ğŸ¤” Rust ã¯æœ€é©åŒ–ã—ãªã„ã£ã¦ã©ã†ã„ã†ã“ã¨ï¼Ÿ

- C ã‚„ Scala ã®ä¸€éƒ¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯ Tail Call Optimization (TCO) ã‚’è¡Œã†
- Rust ã¯ TCO ã‚’ä¿è¨¼ã—ãªã„
  - å†å¸°ãŒæ·±ã„å ´åˆã€loop + æ˜ç¤ºçš„ãªã‚¹ã‚¿ãƒƒã‚¯æ“ä½œã§ç½®ãæ›ãˆã‚‹é‡ãŒæ¨å¥¨ã•ã‚Œã‚‹

## ğŸ” Rust ã§å†å¸°ã‚’ãƒ«ãƒ¼ãƒ—ã«æ›¸ãæ›ãˆã‚‹

```rs
fn factorial_loop(mut n: u32) -> u32 {
    let mut acc = 1;
    while n > 0 {
        acc *= n;
        n -= 1;
    }
    acc
}
```

ãƒ«ãƒ¼ãƒ—ã«å¤‰æ›ã™ã‚‹ã“ã¨ã§ã€å®‰å…¨ã«æ·±ã„è¨ˆç®—ãŒã§ãã‚‹ã€‚

## âœ… å®Ÿç”¨ã§ã¯ã©ã†ã™ã‚‹ï¼Ÿ

- å†å¸°ã¯ã¾ãšè€ƒãˆã‚‹ï¼ˆè¨­è¨ˆãŒã‚·ãƒ³ãƒ—ãƒ«ï¼‰
- æ·±ã„å†å¸° or ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒé‡è¦ â†’ ãƒ«ãƒ¼ãƒ—ã«æ›¸ãæ›ãˆ or ã‚¹ã‚¿ãƒƒã‚¯ã‚’æ‰‹å‹•ç®¡ç†

## ğŸ§ª æ¼”ç¿’

æ¬¡ã®å†å¸°ã‚’æœ«å°¾å†å¸°åŒ–ã—ã¦ãã ã•ã„ï¼š

```rs
fn sum(n: u32) -> u32 {
    if n == 0 {
        0
    } else {
        n + sum(n - 1)
    }
}
```

æœ«å°¾å†å¸°ç‰ˆï¼ˆ`sum_tail(n, acc)`ï¼‰ ã‚’ Rust ã§æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†ï¼
